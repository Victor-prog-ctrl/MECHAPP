<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="icon" type="image/png" href="/assets/logo.png" />
    <title>Panel de administración | AutoServ</title>
    <link rel="stylesheet" href="../Styles/paginainicio.css" />
    <link rel="stylesheet" href="../Styles/admin.css" />
    <link rel="stylesheet" href="../Styles/chatbot.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <header class="site-header admin-header" aria-label="Barra principal">
      <div class="brand admin-brand">
        <img src="../assets/logo-rojo.png" alt="Mechapp" class="brand-logo" />
        <div class="admin-brand__copy">
          <span class="brand-name">Mechapp</span>
          <p class="admin-brand__subtitle">Panel de administración</p>
        </div>
      </div>
      <nav class="main-nav admin-nav" aria-label="Secciones del panel">
        <a href="#resumen" class="nav-link active">Resumen</a>
        <a href="#cotizaciones" class="nav-link">Comisiones</a>
        <a href="#usuarios" class="nav-link">Usuarios</a>
        <a href="#workshops" class="nav-link">Talleres</a>
      </nav>
      <div class="header-actions">
        <button class="button button-primary" id="logout-button" type="button">Cerrar sesión</button>
      </div>
    </header>

    <main class="admin-main">
      <section class="admin-card" id="resumen" aria-labelledby="resumen-title">
        <div class="card-header">
          <h2 id="resumen-title">Resumen general</h2>
          <p class="card-subtitle">Monitorea usuarios y certificados en tiempo real.</p>
        </div>
        <div class="stats-grid" id="dashboard-stats" aria-live="polite"></div>
      </section>

      <section class="admin-card" id="cotizaciones" aria-labelledby="cotizaciones-title">
        <div class="card-header">
          <div>
            <h2 id="cotizaciones-title">Comisiones pendientes</h2>
          <p class="card-subtitle">
            Revisa las comisiones pendientes por mecánico para saber quién falta por pagar.
          </p>
        </div>
        <p class="card-subtitle" id="pending-commissions-summary">Sin comisiones pendientes.</p>
      </div>

      <div class="table-container" role="region" aria-live="polite">
        <table class="admin-table admin-table--compact">
          <thead>
            <tr>
              <th scope="col">Mecánico</th>
              <th scope="col">Comisiones pendientes</th>
              <th scope="col">Monto adeudado</th>
              <th scope="col">Detalle</th>
            </tr>
          </thead>
          <tbody id="pending-commissions-body"></tbody>
        </table>
        <div id="pending-commissions-empty" class="empty-state" hidden>
          <p>No hay comisiones pendientes en este momento.</p>
        </div>
      </div>
      </section>

      <section class="admin-card" id="usuarios" aria-labelledby="usuarios-title">
        <div class="card-header">
          <div>
            <h2 id="usuarios-title">Gestión de usuarios</h2>
            <p class="card-subtitle">Valida certificados, actualiza permisos y revisa registros.</p>
          </div>
          <div class="table-actions">
            <label class="filter">
              <span>Filtrar por tipo</span>
              <select id="filter-account-type" aria-label="Filtrar usuarios por tipo de cuenta">
                <option value="todos">Todos</option>
                <option value="admin">Administradores</option>
                <option value="mecanico">Mecánicos</option>
                <option value="cliente">Clientes</option>
              </select>
            </label>
            <label class="filter">
              <span>Filtrar por estado</span>
              <select id="filter-certificate-status" aria-label="Filtrar usuarios por estado del certificado">
                <option value="todos">Todos</option>
                <option value="pendiente">Pendiente</option>
                <option value="validado">Validado</option>
                <option value="rechazado">Rechazado</option>
              </select>
            </label>
          </div>
        </div>

        <div class="table-container" role="region" aria-live="polite">
          <table class="admin-table">
            <thead>
              <tr>
                <th scope="col">Usuario</th>
                <th scope="col">Correo</th>
                <th scope="col">Tipo de cuenta</th>
                <th scope="col">Certificado</th>
                <th scope="col">Registrado</th>
                <th scope="col" class="col-actions">Acciones</th>
              </tr>
            </thead>
            <tbody id="users-table-body"></tbody>
          </table>
          <div id="users-empty-state" class="empty-state" hidden>
            <p>No se encontraron usuarios con los filtros seleccionados.</p>
          </div>
        </div>
      </section>

      <section class="admin-card" id="workshops" aria-labelledby="workshops-title">
        <div class="card-header">
          <div>
            <h2 id="workshops-title">Talleres registrados</h2>
            <p class="card-subtitle">
              Consulta los talleres creados en la plataforma y los datos de sus propietarios.
            </p>
          </div>
        </div>

        <div class="table-container" role="region" aria-live="polite">
          <table class="admin-table">
            <thead>
              <tr>
                <th scope="col">Taller</th>
                <th scope="col">Propietario</th>
                <th scope="col">Contacto</th>
                <th scope="col">Especialidades</th>
                <th scope="col">Reseñas</th>
              </tr>
            </thead>
            <tbody id="workshops-table-body"></tbody>
          </table>
          <div id="workshops-empty-state" class="empty-state" hidden>
            <p>Por ahora no hay talleres registrados en la plataforma.</p>
          </div>
        </div>
      </section>
    </main>

    <template id="user-row-template">
      <tr class="user-row" data-user-row>
        <td data-user-name></td>
        <td data-user-email></td>
        <td>
          <label class="sr-only" data-account-label>Tipo de cuenta</label>
          <select class="inline-select" data-account-select>
            <option value="admin">Administrador</option>
            <option value="mecanico">Mecánico</option>
            <option value="cliente">Cliente</option>
          </select>
        </td>
        <td class="certificate-cell">
          <div class="certificate-status">
            <span class="status-indicator" data-certificate-indicator></span>
            <select class="inline-select" data-certificate-select>
              <option value="pendiente">Pendiente</option>
              <option value="validado">Validado</option>
              <option value="rechazado">Rechazado</option>
            </select>
          </div>
        </td>
        <td data-user-date></td>
        <td class="col-actions">
          <div class="actions">
            <button class="ghost-button" type="button" data-action="view-certificate" hidden>Ver certificado</button>
            <button class="ghost-button" type="button" data-action="update-certificate">Actualizar certificado</button>
            <button class="ghost-button" type="button" data-action="update-account">Actualizar rol</button>
          </div>
          <p class="feedback" data-row-feedback hidden></p>
        </td>
      </tr>
    </template>

    <script src="../src/chatbot.js" defer></script>
    <script src="../src/admin.js" type="module"></script>
  </body>
</html>
